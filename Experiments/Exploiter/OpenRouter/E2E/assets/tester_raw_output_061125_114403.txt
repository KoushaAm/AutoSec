```java
import org.junit.jupiter.api.*;
import org.mockito.*;
import java.util.*;
import java.util.regex.*;

public class CommandInjectionTest {

    @Mock
    private Runtime runtime;

    private PerfectoBuildWrapper builder;

    @BeforeEach
    void setUp() {
        MockitoAnnotations.openMocks(this);
        builder = new PerfectoBuildWrapper();
        builder.setCredentials(mockCredentials(""));
    }

    @Test
    void testNormalInput() {
        builder.setCredentials(mockCredentials("normal.txt"));
        executeAndCaptureCommand();
        verifyCommandSafe("normal.txt");
        writeReport("normal.txt");
    }

    @Test
    void testSemiMaliciousInput() {
        builder.setCredentials(mockCredentials("file; ls -la"));
        executeAndCaptureCommand();
        verifyCommandUnsafe("file; ls -la");
        writeReport("file; ls -la");
    }

    @Test
    void testMaliciousInput() {
        builder.setCredentials(mockCredentials("file && echo x"));
        executeAndCaptureCommand();
        verifyCommandUnsafe("file && echo x");
        writeReport("file && echo x");
    }

    private Credentials mockCredentials(String apiKey) {
        Credentials mock = Mockito.mock(Credentials.class);
        Secret secret = new Secret(apiKey);
        Mockito.when(mock.getPassword()).thenReturn(secret);
        return mock;
    }

    private void executeAndCaptureCommand() {
        ArgumentCaptor<String[]> captor = ArgumentCaptor.forClass(String[].class);
        Mockito.verify(runtime).exec(captor.capture());
    }

    private void verifyCommandSafe(String input) {
        assertTrue(isCommandSafe(input), "Command should contain only allowed characters");
    }

    private void verifyCommandUnsafe(String input) {
        assertFalse(isCommandSafe(input), "Command should contain forbidden characters");
    }

    private boolean isCommandSafe(String input) {
        return input.matches("[A-Za-z0-9._-]+");
    }

    private void writeReport(String input) {
        String report = "Vulnerability Rule ID: java/my-command-line-injection-extra\n" +
                        "CWE ID: cwe-78\n" +
                        "InputsTested: [\"" + input + "\"]\n" +
                        "Exploitable: " + (isCommandSafe(input) ? "NO" : "YES") + "\n" +
                        "Rationale: " + (isCommandSafe(input) ? "Command contains only allowed characters" : "Command contains forbidden characters") + "\n" +
                        "Procedure: Tested input \"" + input + "\" through command construction";
        Write.write("report.txt", report);
    }

    static class Secret {
        private final String value;
        public Secret(String value) { this.value = value; }
        public String getPlainText() { return value; }
    }

    static class Credentials {
        public Secret getPassword() { return new Secret(""); }
    }

    static class PerfectoBuildWrapper {
        void setCredentials(Credentials cred) {}
        void build() { runtime.exec(cmdArgs()); }
        String[] cmdArgs() {
            String apiKey = new Credentials().getPassword().getPlainText();
            String baseCommand = "safeCommand" + apiKey.trim();
            return new String[]{"bash", "-c", baseCommand};
        }
    }
}
```
