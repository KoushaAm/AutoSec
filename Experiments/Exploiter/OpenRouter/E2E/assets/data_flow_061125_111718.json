{
  "raw_response": "[\n  {\n    \"role\": \"Source\",\n    \"code\": \"Secret apiKeySecret = Secret.fromString(apiKeyValue);\",\n    \"variable\": \"apiKeySecret\",\n    \"file\": \"src/main/java/io/plugins/perfecto/credentials/PerfectoCredentials.java\",\n    \"start_line\": 151,\n    \"remarks\": \"External input sourced via fromString() into a Secret object\"\n  },\n  {\n    \"role\": \"Intermediate\",\n    \"code\": \"Secret apiKeySecret = credentials.getPassword();\",\n    \"variable\": \"apiKeySecret\",\n    \"file\": \"src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java\",\n    \"start_line\": 218,\n    \"remarks\": \"Retrieval of secret from credentials object\"\n  },\n  {\n    \"role\": \"Intermediate\",\n    \"code\": \"String apiKey = apiKeySecret.getPlainText();\",\n    \"variable\": \"apiKey\",\n    \"file\": \"src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java\",\n    \"start_line\": 218,\n    \"remarks\": \"Extraction of plaintext value from Secret\"\n  },\n  {\n    \"role\": \"Intermediate\",\n    \"code\": \"String baseCommand = pcLocation.trim()+\\\" start -c \\\"+cloudName.trim()+\\\".perfectomobile.com -s \\\"+apiKey.trim();\",\n    \"variable\": \"baseCommand\",\n    \"file\": \"src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java\",\n    \"start_line\": 160,\n    \"remarks\": \"Construction of command string using tainted apiKey\"\n  },\n  {\n    \"role\": \"Intermediate\",\n    \"code\": \"String cmdArgs[] = {\\\"bash\\\", \\\"-c\\\", \\\"(cd \\\"+perfectoConnectLocation+\\\"; \\\"+baseCommand+\\\" \\\"+pcParameters.trim()+\\\")\\\"};\",\n    \"variable\": \"cmdArgs\",\n    \"file\": \"src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java\",\n    \"start_line\": 166,\n    \"remarks\": \"Command arguments array assembled with tainted baseCommand\"\n  },\n  {\n    \"role\": \"Sink\",\n    \"code\": \"process = Runtime.getRuntime().exec(cmdArgs);\",\n    \"variable\": \"cmdArgs\",\n    \"file\": \"src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java\",\n    \"start_line\": 167,\n    \"remarks\": \"Dangerous execution of externally influenced command\"\n  }\n]\n</FLOW>",
  "flow": [
    {
      "role": "Source",
      "code": "Secret apiKeySecret = Secret.fromString(apiKeyValue);",
      "variable": "apiKeySecret",
      "file": "src/main/java/io/plugins/perfecto/credentials/PerfectoCredentials.java",
      "start_line": 151,
      "remarks": "External input sourced via fromString() into a Secret object"
    },
    {
      "role": "Intermediate",
      "code": "Secret apiKeySecret = credentials.getPassword();",
      "variable": "apiKeySecret",
      "file": "src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java",
      "start_line": 218,
      "remarks": "Retrieval of secret from credentials object"
    },
    {
      "role": "Intermediate",
      "code": "String apiKey = apiKeySecret.getPlainText();",
      "variable": "apiKey",
      "file": "src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java",
      "start_line": 218,
      "remarks": "Extraction of plaintext value from Secret"
    },
    {
      "role": "Intermediate",
      "code": "String baseCommand = pcLocation.trim()+\" start -c \"+cloudName.trim()+\".perfectomobile.com -s \"+apiKey.trim();",
      "variable": "baseCommand",
      "file": "src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java",
      "start_line": 160,
      "remarks": "Construction of command string using tainted apiKey"
    },
    {
      "role": "Intermediate",
      "code": "String cmdArgs[] = {\"bash\", \"-c\", \"(cd \"+perfectoConnectLocation+\"; \"+baseCommand+\" \"+pcParameters.trim()+\")\"};",
      "variable": "cmdArgs",
      "file": "src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java",
      "start_line": 166,
      "remarks": "Command arguments array assembled with tainted baseCommand"
    },
    {
      "role": "Sink",
      "code": "process = Runtime.getRuntime().exec(cmdArgs);",
      "variable": "cmdArgs",
      "file": "src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java",
      "start_line": 167,
      "remarks": "Dangerous execution of externally influenced command"
    }
  ],
  "evidence_count": 6
}