{
  "raw_response": "<FLOW>\n[\n  {\n    \"role\": \"Source\",\n    \"code\": \"fromString(...) : Secret\",\n    \"variable\": \"secretInput\",\n    \"file\": \"src/main/java/io/plugins/perfecto/credentials/PerfectoCredentials.java\",\n    \"start_line\": 151,\n    \"remarks\": \"External input (secret) obtained via fromString() method\"\n  },\n  {\n    \"role\": \"Intermediate\",\n    \"code\": \"getPassword(...) : Secret\",\n    \"variable\": \"password\",\n    \"file\": \"src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java\",\n    \"start_line\": 218,\n    \"remarks\": \"Secret processed and passed to baseCommand construction\"\n  },\n  {\n    \"role\": \"Intermediate\",\n    \"code\": \"baseCommand = ... + apiKey.trim()\",\n    \"variable\": \"apiKey\",\n    \"file\": \"src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java\",\n    \"start_line\": 160,\n    \"remarks\": \"apiKey (from secret) concatenated into command string\"\n  },\n  {\n    \"role\": \"Intermediate\",\n    \"code\": \"cmdArgs = {\\\"cmd.exe\\\", \\\"/c\\\", baseCommand + ...}\",\n    \"variable\": \"cmdArgs\",\n    \"file\": \"src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java\",\n    \"start_line\": 166,\n    \"remarks\": \"Tainted command string assembled with untrusted input\"\n  },\n  {\n    \"role\": \"Sink\",\n    \"code\": \"Runtime.getRuntime().exec(cmdArgs)\",\n    \"variable\": \"cmdArgs\",\n    \"file\": \"src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java\",\n    \"start_line\": 167,\n    \"remarks\": \"Command execution with unvalidated input\"\n  }\n]</FLOW>\n",
  "flow": [
    {
      "role": "Source",
      "code": "fromString(...) : Secret",
      "variable": "secretInput",
      "file": "src/main/java/io/plugins/perfecto/credentials/PerfectoCredentials.java",
      "start_line": 151,
      "remarks": "External input (secret) obtained via fromString() method"
    },
    {
      "role": "Intermediate",
      "code": "getPassword(...) : Secret",
      "variable": "password",
      "file": "src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java",
      "start_line": 218,
      "remarks": "Secret processed and passed to baseCommand construction"
    },
    {
      "role": "Intermediate",
      "code": "baseCommand = ... + apiKey.trim()",
      "variable": "apiKey",
      "file": "src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java",
      "start_line": 160,
      "remarks": "apiKey (from secret) concatenated into command string"
    },
    {
      "role": "Intermediate",
      "code": "cmdArgs = {\"cmd.exe\", \"/c\", baseCommand + ...}",
      "variable": "cmdArgs",
      "file": "src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java",
      "start_line": 166,
      "remarks": "Tainted command string assembled with untrusted input"
    },
    {
      "role": "Sink",
      "code": "Runtime.getRuntime().exec(cmdArgs)",
      "variable": "cmdArgs",
      "file": "src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java",
      "start_line": 167,
      "remarks": "Command execution with unvalidated input"
    }
  ],
  "evidence_count": 6
}