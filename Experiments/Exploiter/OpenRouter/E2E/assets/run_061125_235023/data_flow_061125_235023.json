{
  "raw_response": "<FLOW>\n[\n  {\n    \"role\": \"Source\",\n    \"code\": \"fromString(...) : Secret\",\n    \"variable\": \"input string (untrusted)\",\n    \"file\": \"src/main/java/io/plugins/perfecto/credentials/PerfectoCredentials.java\",\n    \"start_line\": 151,\n    \"remarks\": \"Untrusted input parsed via fromString(...) in PerfectoCredentials.java\"\n  },\n  {\n    \"role\": \"Intermediate\",\n    \"code\": \"apiKey.trim()\",\n    \"variable\": \"apiKey\",\n    \"file\": \"src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java\",\n    \"start_line\": 160,\n    \"remarks\": \"apiKey from PerfectoCredentials.java used in command construction\"\n  },\n  {\n    \"role\": \"Source\",\n    \"code\": \"cloudNameInput.trim()\",\n    \"variable\": \"cloudNameInput\",\n    \"file\": \"src/test/java/PerfectoPathInjectionTest.java\",\n    \"start_line\": 116,\n    \"remarks\": \"User-provided input from test case\"\n  },\n  {\n    \"role\": \"Intermediate\",\n    \"code\": \"baseCommand + \\\" ... \\\" + apiKey.trim()\",\n    \"variable\": \"baseCommand\",\n    \"file\": \"src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java\",\n    \"start_line\": 160,\n    \"remarks\": \"Command string assembled with untrusted apiKey and cloudNameInput\"\n  },\n  {\n    \"role\": \"Intermediate\",\n    \"code\": \"baseCommand + \\\" \\\" + pcParameters.trim()\",\n    \"variable\": \"cmdArgs\",\n    \"file\": \"src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java\",\n    \"start_line\": 162,\n    \"remarks\": \"Final command array constructed with concatenated inputs\"\n  },\n  {\n    \"role\": \"Sink\",\n    \"code\": \"Runtime.getRuntime().exec(cmdArgs)\",\n    \"variable\": \"cmdArgs\",\n    \"file\": \"src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java\",\n    \"start_line\": 167,\n    \"remarks\": \"Vulnerable command execution with unvalidated input\"\n  }\n]</FLOW>\n",
  "flow": [
    {
      "role": "Source",
      "code": "fromString(...) : Secret",
      "variable": "input string (untrusted)",
      "file": "src/main/java/io/plugins/perfecto/credentials/PerfectoCredentials.java",
      "start_line": 151,
      "remarks": "Untrusted input parsed via fromString(...) in PerfectoCredentials.java"
    },
    {
      "role": "Intermediate",
      "code": "apiKey.trim()",
      "variable": "apiKey",
      "file": "src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java",
      "start_line": 160,
      "remarks": "apiKey from PerfectoCredentials.java used in command construction"
    },
    {
      "role": "Source",
      "code": "cloudNameInput.trim()",
      "variable": "cloudNameInput",
      "file": "src/test/java/PerfectoPathInjectionTest.java",
      "start_line": 116,
      "remarks": "User-provided input from test case"
    },
    {
      "role": "Intermediate",
      "code": "baseCommand + \" ... \" + apiKey.trim()",
      "variable": "baseCommand",
      "file": "src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java",
      "start_line": 160,
      "remarks": "Command string assembled with untrusted apiKey and cloudNameInput"
    },
    {
      "role": "Intermediate",
      "code": "baseCommand + \" \" + pcParameters.trim()",
      "variable": "cmdArgs",
      "file": "src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java",
      "start_line": 162,
      "remarks": "Final command array constructed with concatenated inputs"
    },
    {
      "role": "Sink",
      "code": "Runtime.getRuntime().exec(cmdArgs)",
      "variable": "cmdArgs",
      "file": "src/main/java/io/plugins/perfecto/PerfectoBuildWrapper.java",
      "start_line": 167,
      "remarks": "Vulnerable command execution with unvalidated input"
    }
  ],
  "evidence_count": 6
}