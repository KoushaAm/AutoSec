import json

# this helper function extracts the results.json from Finder and passes on the first code flow the Exploiter
def get_code_flow(filename = "/vuln_agent/modules/data/raw/result.json"):
    with open(filename) as json_file:
        data = json.load(json_file)

    for key, value in data["runs"][0]["results"][0].items():
        print(key)

    data = data["runs"][0]["results"]

    res = []
    for i in range(len(data)):
        res.append(data[i]["codeFlows"])

    # return the first full code flow
    for item in res:
        if item:
            return item
    else:
        return None

# print(get_code_flow())


