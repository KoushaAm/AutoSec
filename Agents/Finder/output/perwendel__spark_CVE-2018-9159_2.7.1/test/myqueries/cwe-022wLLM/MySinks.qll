import java
import semmle.code.java.dataflow.DataFlow
private import semmle.code.java.dataflow.ExternalFlow

predicate isGPTDetectedSink(DataFlow::Node snk) {
    exists(Call c |
        c.getCallee().getName() = "setContentType" and
        c.getCallee().getDeclaringType().getSourceDeclaration().hasQualifiedName("javax.servlet", "ServletResponse") and
        ( c.getArgument(0) = snk.asExpr().(Argument) )
    )
    or
    exists(Call c |
        c.getCallee().getName() = "sendRedirect" and
        c.getCallee().getDeclaringType().getSourceDeclaration().hasQualifiedName("javax.servlet.http", "HttpServletResponse") and
        ( c.getArgument(0) = snk.asExpr().(Argument) )
    )
    or
    exists(Call c |
        c.getCallee().getName() = "setHeader" and
        c.getCallee().getDeclaringType().getSourceDeclaration().hasQualifiedName("javax.servlet.http", "HttpServletResponse") and
        ( c.getArgument(1) = snk.asExpr().(Argument) )
    )
    or
    exists(Call c |
        c.getCallee().getName() = "addHeader" and
        c.getCallee().getDeclaringType().getSourceDeclaration().hasQualifiedName("javax.servlet.http", "HttpServletResponse") and
        ( c.getArgument(1) = snk.asExpr().(Argument) )
    )
    or
    exists(Call c |
        c.getCallee().getName() = "setTrustStorePath" and
        c.getCallee().getDeclaringType().getSourceDeclaration().hasQualifiedName("org.eclipse.jetty.util.ssl", "SslContextFactory") and
        ( c.getArgument(0) = snk.asExpr().(Argument) )
    )
    or
    exists(Call c |
        c.getCallee().getName() = "FileNotFoundException" and
        c.getCallee().getDeclaringType().getSourceDeclaration().hasQualifiedName("java.io", "FileNotFoundException") and
        ( c.getArgument(0) = snk.asExpr().(Argument) )
    )
    or
    exists(Call c |
        c.getCallee().getName() = "getResource" and
        c.getCallee().getDeclaringType().getSourceDeclaration().hasQualifiedName("java.lang", "Class") and
        ( c.getArgument(0) = snk.asExpr().(Argument) )
    )
    or
    exists(Call c |
        c.getCallee().getName() = "getResource" and
        c.getCallee().getDeclaringType().getSourceDeclaration().hasQualifiedName("java.lang", "ClassLoader") and
        ( c.getArgument(0) = snk.asExpr().(Argument) )
    )
    or
    exists(Call c |
        c.getCallee().getName() = "getResourceAsStream" and
        c.getCallee().getDeclaringType().getSourceDeclaration().hasQualifiedName("java.lang", "Class") and
        ( c.getArgument(0) = snk.asExpr().(Argument) )
    )
    or
    exists(Call c |
        c.getCallee().getName() = "getResourceAsStream" and
        c.getCallee().getDeclaringType().getSourceDeclaration().hasQualifiedName("java.lang", "ClassLoader") and
        ( c.getArgument(0) = snk.asExpr().(Argument) )
    )
    or
    exists(Call c |
        c.getCallee().getName() = "get" and
        c.getCallee().getDeclaringType().getSourceDeclaration().hasQualifiedName("java.nio.file", "Paths") and
        ( c.getArgument(0) = snk.asExpr().(Argument)  or  c.getArgument(1) = snk.asExpr().(Argument) )
    )
    or
1 = 0
    or
    exists(Call c |
        c.getCallee().getName() = "FileWriter" and
        c.getCallee().getDeclaringType().getSourceDeclaration().hasQualifiedName("java.io", "FileWriter") and
        ( c.getArgument(0) = snk.asExpr().(Argument) )
    )
    or
    exists(Call c |
        c.getCallee().getName() = "URLClassLoader" and
        c.getCallee().getDeclaringType().getSourceDeclaration().hasQualifiedName("java.net", "URLClassLoader") and
        ( c.getArgument(0) = snk.asExpr().(Argument) )
    )
    or
    exists(Call c |
        c.getCallee().getName() = "NCSARequestLog" and
        c.getCallee().getDeclaringType().getSourceDeclaration().hasQualifiedName("org.eclipse.jetty.server", "NCSARequestLog") and
        ( c.getArgument(0) = snk.asExpr().(Argument) )
    )
    or
1 = 0
    or
    exists(Call c |
        c.getCallee().getName() = "setContextPath" and
        c.getCallee().getDeclaringType().getSourceDeclaration().hasQualifiedName("org.eclipse.jetty.server.handler", "ContextHandler") and
        ( c.getArgument(0) = snk.asExpr().(Argument) )
    )
    or
    exists(Call c |
        c.getCallee().getName() = "setWar" and
        c.getCallee().getDeclaringType().getSourceDeclaration().hasQualifiedName("org.eclipse.jetty.webapp", "WebAppContext") and
        ( c.getArgument(0) = snk.asExpr().(Argument) )
    )
}


